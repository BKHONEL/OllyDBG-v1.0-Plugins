20.09.2012 VMSweeper 1.5 beta 2
VmProtect
Добавлено:
1. Обработчик "пустого" выхода из ВМ.
2. Декомпиляция табличных переходов (switch конструкции).
3. Обработка невиртуализованной инструкции sbb.

5.05.2012 VMSweeper 1.5 beta 1
VmProtect
Добавлено:
1. Создание меток без переходов на них.
2. Улучшена декомпиляция зон кода.

12.04.2012 VMSweeper 1.5 beta 0
VmProtect
Добавлено:
1. Обработчик примитива вызова простой функции без аргументов и возвращаемого значения.
2. Распознавание примитивов Push/Pop RvmLong с индексацией пикодом.
3. Обработка нескольких ВМ на одной функции, как пакетно, так и отдельным вызовом функции
   (опция Decompilate packet в ini файле). Рекомендуется отключить, но если имеются
   сложности с нахождением точки входа в пакетную функцию, то следует опцию включить.
4. Декомпиляция кода в зонах смены регистров (опция Decompilate change register zones в ini файле).
   При включении эта опция создает дополнительный "мусор" в log файле, рекомендуется использовать
   только в том случае, если созданный код без этой опции имеет пропущенные инструкции.
5. Много мелких косметических нюансов.
Исправлено:
1. Реструктуризация промкода.
2. Определение размера аргументов вызываемых функций.

03.11.2011 VMSweeper 1.4 beta 15
Добавлено:
1. CodeVirtualizer: Улучшено распознавание примитива CMC.
2. CodeVirtualizer: Добавлена обработка интструкции setne.
3. CodeVirtualizer: Улучшено распознавание старших байтовых регистров (ah, ch, dh, bh).
4. VmProtect: Реализована обработка смещения кода ВМ (relocation VM code).
5. VmProtect: Обработчики FPU инструкций fst, fisub.
Исправлено:
1. CodeVirtualizer: Вставка прямых асм инструкций в исходный код.
2. VmProtect: Перемещение оператора изменения флагов к своим флагам.
3. VmProtect: Восстановление импорта, иногда вместо call [api] восстанавливалось jmp [api].

01.09.2011 VMSweeper 1.4 beta 14
Добавлено:
1. CodeVirtualizer: Удаление инициализированного, но не используемого регистра RVM_TMP.
2. CodeVirtualizer: Коррекция вершины стека ВМ при его расширении.
3. CodeVirtualizer: Коррекция дна стека ВМ при входе в промежуточный сеанс ВМ.
4. CodeVirtualizer: Вывод в trc файл адреса входа в следующий сеанс ВМ.
5. Обработка операции neg в константных выражениях.
6. Обработчик исключения переполнения при эмуляции инструкций div и idiv.
7. Улучшен определитель числа аргументов вызываемых функций, т.к. OllyDbg иногда это делает неправильно.
8. Одновременная обработка константных выражений размещенных в паре регистров xL - xH.
9. Уменьшение размера восстановленного кода за счет удаления необязательного ds: префикса.
10. VmProtect: Улучшен анализатор алгоритма кодирования пикода в цикле ВМ.
11. VmProtect: Обработчик FPU инструкции fsubr.
12. В ручном режиме работы удалено окно "Stop on EntryCall".
Исправлено:
1. Условный переход из примитива ВМ на начало цикла ВМ не является завершением примитива.
2. Анализ OF флага на расширенных байтовых переменных.


03.08.2011 VMSweeper 1.4 beta 13
Исправлено:
1. Ошибка переполнения текстового буфера при формировании длинных выражений,
что приводило к исключению на стадии анализа кода.


19.06.2011 VMSweeper 1.4 beta 12
Исправлено:
1. Исправлено несколько ошибок в декомпиляторе CodeVirtualizer, внесенных при
разработке Декомпилятора VMProtect, что позволяет в большинстве случаев (если ВМ
успешно распознается) получать 100% исходный код.


17.05.2011 VMSweeper 1.4 beta 11
Добавлено:
1. Обработчики FPU инструкций: fclex, fldcw, fstcw, fldz, fld1, fistp.
2. Окно ввода значений сегментов кода и ВМ теперь имеет три кнопки:
   - Analyze - начать анализ точек входа в ВМ и восстановление импорта.
   - Accept  - принять введенные значения сегментов без выполнения анализа.
   - Cancel  - выйти не производя никаких изменений.
3. Вывод имен API функций в картах пикода, релоков и вызовов функций.
4. Девиртуализация инструкции add esp, xx
5. Улучшено восстановление частично затертой IAT.
6. Восстановление импорта типа: push reg; call vm -> call [api].
7. Восстановление импорта типа: push/pop reg; call vm -> mov reg,[api].
8. Улучшено распознавание точек входа в ВМ.
9. Улучшено распознавание цикла ВМ.
Исправлено:
1. Преобразование кода pop xx; jmp xx в retn.
2. Реструктуризация промкода. Пересечения блоков.
3. Устранено несколько исключений при девиртуализации кода.
4. Удаление кода антидампа.


27.02.2011 VMSweeper 1.4 beta 10
Добавлено:
1. Улучшена разметка полностью затертой IAT.
2. Улучшено распознавание имен API функций.
3. Изменение размера виртуального сегмента под промкод (опция VMS size в ini файле).
4. Отслеживание содержимого памяти и всего стека при создании промкода.
5. Улучшена девиртуализация условных переходов.
6. Анализатор кода распознает ещё два вида кода: чистый и обфускированный. Ранее они находились в группе "Cancelled".
7. Девиртуализация инструкции sub esp без флагов.
8. Обработка входа в ВМ типа call xx (позволяет декомпилировать любой промежуточный вход в ВМ).
9. Автоматический режим анализа кода ВМ. Переход в этот режим осуществляется по запросу после первого рестарта приложения.
   Код, полученный в этом режиме, может быть хуже кода полученного в ручном режиме ( Ctrl+F2 -> [ F9 ] -> Shift+F1 ), но
   позволяет быстро проверить возможность декомпилируемости кода. В этом режиме работает только статический анализатор кода.
Исправлено:
1. Обработка транзитного (пустого) выхода из ВМ.
2. Устранено исключение при восстановлении соответствия регистров ВМ и CPU.
3. Определение количества аргументов обфускированной функции.
4. Пикод может детектироваться в любом сегменте исследуемой программы.


15.02.2011 VMSweeper 1.4 beta 9
Добавлено:
1. Совместный доступ ко всем файлам, создаваемым VMSweeper.
2. Вместо подсчета CRC делается коррекция CRC.
3. Обработчики FPU инструкций: fsub, fmul, fdiv и fabs.
4. Блокировка "Analyze all VM references" от повторного запуска.
5. Оптимизация log, trc и map файлов.
6. Обработка транзитных меток в промкоде при отсутствии перехода на них.
7. Реструктуризация промкода. Обработка входа в ВМ, совмещенного с меткой.
8. Девиртуализация инструкции cpuid.
9. Удаление AntiDump и AntiTrace кода.
10. Улучшен конвертер PMB to GDL.
Исправлено:
1. Восстановление множителя в SIB адресации.
2. Реструктуризация промкода. Удаление лишних ветвлений.


04.02.2011 VMSweeper 1.4 beta 8
Добавлено:
1. Улучшено распознавание транзитных меток.
2. Улучшено распознавание условных переходов.
3. Улучшено распознавание использования переменной при её частичном переприсвоении.
4. Удаление декодирования адреса безусловного перехода.
5. Второй алгоритм подсчета CRC для VMProtect версии выше 2.0
6. Защита DRx регистров (аппаратных точек останова) от VMProtect.
7. Обработка прямого вызова АПИ после кодированного выхода из ВМ.
Исправлено:
1. Реструктуризация промкода. Иногда прямая ветка после условного перехода шла не на следующий блок.
2. Реструктуризация промкода. Для невырожденного безусловного перехода добавляется зона метки.
3. Распознавание использования регистра ВМ в строке с его инициализацией.
4. Девиртуализация инструкции retn xx теперь не зависит от кол-ва переменных вм в стеке.
5. Метка вырожденного перехода не удаляется если на неё идут другие переходы.
6. Устранено переполнение стека и исключение при поиске соответствия регистров вм и CPU в цикле.
7. При автоматическом рестарте программы не активировалась опция AntiAntiDebug.



28.01.2011 VMSweeper 1.4 beta 7
Добавлено:
1. Опция AntiAntiDebug.
2. Опция Break on TLS.
3. Первоначальная обработка AntiDump.
4. Девиртуализация инструкции retn xx.
5. Девиртуализация инструкции sub без флагов.
6. Восстановление скрытого вызова процедуры (типа push xx; retn)
7. Коррекция смещений при адресации стека через esp.
8. Улучшено распознавание начала цикла вм в CodeVirtualizer.
Исправлено:
1. Реструктуризация промкода. Иногда прямая ветка после условного перехода шла в середину следующего блока.
2. Коррекция указателя esp при декомпиляции mov esp, [esp]
3. Восстановление косвенных вызовов процедур.
4. Распознавание соответствия регистров CPU и ВМ на инструкциях pop xx.
